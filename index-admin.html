<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Admin Transfer</title>
<link href="https://fonts.googleapis.com/css2?family=Teko:wght@500&display=swap" rel="stylesheet">
<style>
body{background:#0b1320;color:white;font-family:Teko;margin:0}
header{background:#111c33;padding:15px}
.card{background:#162447;margin:15px;padding:15px;border-radius:12px}
button{margin:5px;padding:8px 12px;border:none;border-radius:6px;cursor:pointer}
.acc{background:#28a745;color:white}
.neg{background:#dc3545;color:white}
.twr{background:#ffc107;color:black}
</style>
</head>
<body>

<header>
<h2>ðŸ›  Admin Transfer Market</h2>
</header>

<div id="list"></div>

<script type="module">
import { db } from './firebase.js';
import {
 collection,onSnapshot,doc,updateDoc
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

onSnapshot(collection(db,'tawaran'),snap=>{
 list.innerHTML='';
 snap.forEach(d=>{
  let x=d.data();
  list.innerHTML+=`
  <div class="card">
   <b>${x.nama}</b> (${x.dari})<br>
   Posisi: ${x.posisi}<br>
   Harga: ${x.harga}<br>
   Status: ${x.status}<br><br>
   <button class="acc" onclick="aksi('${d.id}','Diterima')">Terima</button>
   <button class="twr" onclick="tawar('${d.id}')">Tawar</button>
   <button class="neg" onclick="aksi('${d.id}','Ditolak')">Tolak</button>
  </div>`;
 })
});

window.aksi=async(id,status)=>{
 let alasan=prompt('Alasan:');
 await updateDoc(doc(db,'tawaran',id),{status,alasan});
}

window.tawar=async(id)=>{
 let harga=prompt('Harga baru:');
 let bonus=prompt('Bonus (opsional):');
 await updateDoc(doc(db,'tawaran',id),{
  status:'Ditawar',
  harga:harga,
  bonus:bonus
 });
}
</script>

</body>
</html>
